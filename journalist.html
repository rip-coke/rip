---
layout: page
permalink: /journalist
---


<script type="module">
    const popup = new PaystackPop();
    var url = "<%= html_escape(home_verify_url('code')) %>"
    var form = document.getElementById("obituaryForm");
    
    async function handleSubmit(event) {
      event.preventDefault();

      var status = document.getElementById("obituaryFormStatus");
      var data = new FormData(event.target);
      
      popup.newTransaction({
          key: "{{site.paystack_public_key}}",
          email: 'sample@email.com',
          amount: 7000000,
          onSuccess: (transaction) => {
            data.append("transaction", JSON.stringify(transaction))
            fetch(event.target.action, {
              method: form.method,
              body: data,
              headers: {
                  'Accept': 'application/json'
              }
            }).then(response => {
              if (response.ok) {
                status.innerHTML = `Thank you for choosing Rip.ke to commemorate your loved one. Bikozulu and his team of journalists will be in touch shortly. Reference code ${transaction.reference}`;
                form.style.display="none"
              } else {
                response.json().then(data => {
                  if (Object.hasOwn(data, 'errors')) {
                    status.innerHTML = data["errors"].map(error => error["message"]).join(", ")
                  } else {
                    status.innerHTML = "Oops! There was a problem submitting your form"
                  }
                })
              }
            }).catch(error => {
              status.innerHTML = "Oops! There was a problem submitting your form"
            });
          console.log("Success: ", transaction);
          },
          onLoad: (response) => {
          console.log("onLoad: ", response);
          },
          onCancel: () => {
          console.log("onCancel");
          },
          onError: (error) => {
          console.log("Error: ", error.message);
          },
          onClose: function(){
          alert('Payment window closed');
          }
        });
    }
    form.addEventListener("submit", handleSubmit)
</script>

<div id="content" class="bg-white pb-6 sm:pb-6 text-center">
  <div class="mx-auto flex justify-center">
    <section class="w-full max-w-md bg-white rounded-lg shadow-lg p-8">
      <h1 class="text-2xl font-bold mb-6 text-gray-800 text-center">Bespoke Obituary Request</h1>
      <p id="obituaryFormStatus" class="pb-8"> Please enter some contact details below and submit the form. Bikozulu and his team of journalists will be in touch shortly. Thank you for choosing Rip.ke to commemorate your loved one.  </p>
      <form class="space-y-6" id="obituaryForm" action="https://formspree.io/f/xwpoeark" method="POST">
        <div>
          <input 
            type="hidden" 
            name="url"
            id="url"
          />
          <label for="name" class="block text-gray-700 font-medium mb-2">Name</label>
          <input
            type="text"
            id="name"
            name="name"
            required
            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500"
          />
        </div>
        <div>
          <label for="email" class="block text-gray-700 font-medium mb-2">Email Address</label>
          <input
            type="email"
            id="email"
            name="email"
            required
            pattern="^[^@\s]+@[^@\s]+\.[^@\s]+$"
            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500"
          />
          <p id="emailError" class="text-red-500 text-sm mt-1 hidden">Please enter a valid email address.</p>
        </div>
        <div>
          <label for="phone" class="block text-gray-700 font-medium mb-2">Phone Number</label>
          <input
            type="tel"
            id="phone"
            name="phone"
            required
            pattern="^\+?\d{10,15}$"
            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-500"
          />
          <p id="phoneError" class="text-red-500 text-sm mt-1 hidden">Please enter a valid phone number (10-15 digits).</p>
        </div>
        <button
          id="paystackJouralistBtn"
          class="w-full py-2 px-4 bg-yellow-500 text-white font-semibold rounded-md hover:bg-yellow-600 transition-colors"
          type="submit"
        >
          Submit
        </button>
      </form>
    </section>
  </div>
</div>

<script>
  let emailTimeout, phoneTimeout;

  // Email validation on keyup with timeout
  document.getElementById('email').addEventListener('keyup', function() {
    clearTimeout(emailTimeout);
    emailTimeout = setTimeout(() => {
      const email = this.value;
      const emailError = document.getElementById('emailError');
      const emailPattern = /^[^@\s]+@[^@\s]+\.[^@\s]+$/;
      if (!emailPattern.test(email)) {
        emailError.classList.remove('hidden');
      } else {
        emailError.classList.add('hidden');
      }
    }, 400);
  });

  // Phone validation on keyup with timeout
  document.getElementById('phone').addEventListener('keyup', function() {
    clearTimeout(phoneTimeout);
    phoneTimeout = setTimeout(() => {
      const phone = this.value;
      const phoneError = document.getElementById('phoneError');
      const phonePattern = /^\+?\d{10,15}$/;
      if (!phonePattern.test(phone)) {
        phoneError.classList.remove('hidden');
      } else {
        phoneError.classList.add('hidden');
      }
    }, 400);
  });

  document.getElementById("url").value = window.location.href;
</script>
